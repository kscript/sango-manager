"use strict";(self["webpackChunksango_manager"]=self["webpackChunksango_manager"]||[]).push([[38],{9584:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var n=a(6768),l=a(4232),i=a(144);a(6573),a(8100),a(7936),a(4603),a(7566),a(8721);const s=e=>[255*((63488&e)>>11)/31,255*((2016&e)>>5)/63,255*(31&e)/31].map((e=>Math.floor(e))),c=(e,t,a,n)=>{const l=e.createImageData(a,n);l.data.forEach(((e,a)=>{l.data[a]=t[a]})),e.putImageData(l,0,0)},u=(e,t)=>{const{cache:a}=u;if(a)return a.ctx.clearRect(0,0,a.Width,a.Height),a.canvas.width=e,a.canvas.height=t,u.cache;const n=document.createElement("canvas");n.width=e||300,n.height=t||300;const l=n.getContext("2d");return u.cache={canvas:n,ctx:l},u.cache},o=async(e,t="image/png")=>new Promise((a=>{e.toBlob((e=>{const t=URL.createObjectURL(e);a(t)}),t)})),r=async e=>{const t={};if(e instanceof ArrayBuffer){let a,n,l,i,r,g,d,v,f=0;const h=new DataView(e);if(d=e.byteLength>36?[h.getUint8(0),h.getUint8(1),h.getUint8(2),h.getUint8(3)]:[0,0,0,0],84===d[0]&&76===d[1]&&72===d[2]&&83===d[3]){g=h.getUint8(13),a=h.getUint16(20,1),n=h.getUint16(24,1),l=h.getUint16(28,1),i=h.getUint16(32,1),v=g?80:36,r=new Array(n);let e=0;for(let t=0;t<r.length;t++)r[t]=h.getUint16(v,1),t>0&&e&&e>r[t]?(f++,e=0):e=r[t],r[t]=r[t]+65536*f,v+=4;const d=new Array(n).fill(0).map((e=>new Array(a).fill([0,0,0,0])));for(let t=0;t<r.length;t++)if(g){let e=r[t];while(65535!==h.getUint16(e+2,1)){const n=h.getUint16(e,1)%(a+1),l=h.getUint16(e+2,1),i=h.getUint32(e+4,1);for(let e=l,a=0;e<l+n;e++){const n=h.getUint16(i+a,1);d[t][e]=s(n).concat(255),a+=2}e+=8}}else{let e=r[t];while(65535!==h.getUint16(e,1)){const n=h.getUint16(e,1),l=h.getUint16(e+2,1)%(a+1);e+=2;for(let a=n;a<n+l;a++){const n=h.getUint16(e,1);d[t][a]=s(n).concat(255),e+=2}e+=2}}const{ctx:k,canvas:w}=u(a,n);c(k,d.flat().flat(),a,n);const y=await o(w);Object.assign(t,{url:y,Width:a,Height:n,PosX:l,PosY:i})}}return t},g=e=>((0,n.Qi)("data-v-560545d6"),e=e(),(0,n.jt)(),e),d=g((()=>(0,n.Lk)("span",{class:"text--white"}," 选择shp文件 ",-1))),v={class:"scroll"},f={style:{padding:"10px"}},h={style:{overflow:"auto"}};var k={__name:"ShpView",setup(e){const t=(0,i.KR)([]),a=(0,i.KR)(null),s=async e=>{if(!/\.shp$/i.test(e.name))return!1;const a=await r(await e.arrayBuffer());return t.value=t.value.concat({...a,file:e}),!1},c=e=>{a.value=a.value===e?null:e,a.value&&console.log(u(e))},u=e=>{const{Width:t,Height:a,PosX:n,PosY:l,url:i}=e;return{Width:t,Height:a,PosX:n,PosY:l,url:i}},o=()=>{t.value=[],a.value=null};return window.addEventListener("keydown",(e=>{if("Escape"===e.key)a.value=null;else if(a.value&&[37,39].includes(e.keyCode)){const n=t.value.findIndex((e=>a.value===e));37===e.keyCode&&n>0?a.value=t.value[n-1]:39===e.keyCode&&n<t.value.length-1&&(a.value=t.value[n+1])}})),(e,i)=>{const r=(0,n.g2)("el-button"),g=(0,n.g2)("el-upload"),k=(0,n.g2)("el-row"),w=(0,n.g2)("el-divider"),y=(0,n.g2)("el-image"),p=(0,n.g2)("el-card"),b=(0,n.g2)("el-main"),U=(0,n.g2)("el-aside"),m=(0,n.g2)("el-container");return(0,n.uX)(),(0,n.Wv)(m,null,{default:(0,n.k6)((()=>[(0,n.bF)(b,null,{default:(0,n.k6)((()=>[(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(g,{class:"el-button el-button--text","before-upload":s,"show-file-list":!1,webkitdirectory:"",multiple:""},{trigger:(0,n.k6)((()=>[(0,n.bF)(r,{type:"success"},{default:(0,n.k6)((()=>[d])),_:1})])),_:1}),(0,n.bF)(r,{type:"danger",onClick:o},{default:(0,n.k6)((()=>[(0,n.eW)("清除")])),_:1})])),_:1}),t.value.length?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(w),(0,n.bF)(p,{shadow:"never","border-style":"none"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",v,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.value,(e=>((0,n.uX)(),(0,n.Wv)(y,{key:e.url,class:(0,l.C4)(["file",{active:a.value===e}]),src:e.url,title:e.file.name,onClick:t=>c(e)},null,8,["class","src","title","onClick"])))),128))])])),_:1})],64)):(0,n.Q3)("",!0)])),_:1}),(0,n.bF)(U,null,{default:(0,n.k6)((()=>[a.value?((0,n.uX)(),(0,n.Wv)(p,{key:0,shadow:"never","border-style":"none"},{header:(0,n.k6)((()=>[(0,n.Lk)("div",f,(0,l.v_)(a.value.file.name),1)])),default:(0,n.k6)((()=>[(0,n.Lk)("pre",h,(0,l.v_)(JSON.stringify(u(a.value),null,2)),1)])),_:1})):(0,n.Q3)("",!0)])),_:1})])),_:1})}}},w=a(1241);const y=(0,w.A)(k,[["__scopeId","data-v-560545d6"]]);var p=y}}]);
//# sourceMappingURL=shp.bcd9d3ef.js.map